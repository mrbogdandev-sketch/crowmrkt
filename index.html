<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>CrowMRKT ‚Äî dynamic layout</title>
<style>
:root{
  --bg:#000;
  --panel:#0b0b0b;
  --muted:#9a9a9a;
  --accent:#FFD500;
  --radius:14px;
  --ease:260ms cubic-bezier(.2,.9,.2,1);
  font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:#eaeaea;-webkit-font-smoothing:antialiased;font-size:18px;display:flex;justify-content:center;align-items:center;}
.shell{max-width:1200px;margin:12px auto;padding:16px;display:grid;grid-template-columns:1fr;gap:16px;align-items:start}
.top{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:12px;font-size:1.2em}
.info{display:flex;flex-wrap:wrap;gap:12px;align-items:center}
.coins{display:flex;align-items:center;gap:10px;padding:10px 16px;border-radius:14px;background:var(--panel);border:1px solid #141414;flex-shrink:0;font-size:1.1em}
.coins strong{color:var(--accent);font-weight:900;font-size:1.2em}
.income{color:var(--muted);font-size:0.95em}
.btn{background:var(--accent);border:none;padding:14px 20px;border-radius:14px;color:#000;font-weight:900;cursor:pointer;transition:transform var(--ease);min-height:50px;flex-shrink:0;font-size:1em}
.btn:active{transform:scale(.98)}
.btn--ghost{background:transparent;border:1px solid #222;color:var(--muted);}
.panel{background:var(--panel);padding:16px;border-radius:var(--radius);border:1px solid #151515;min-width:0;overflow:hidden}
h2{margin:0 0 12px 0;font-size:1.2em}
.shop-grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr))}
.card{display:flex;flex-direction:column;gap:10px;padding:16px;border-radius:14px;background:#050505;border:1px solid #151515;min-width:0;font-size:1em}
.row{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:10px}
.bird{display:flex;align-items:center;gap:12px;flex:1;min-width:0}
.emoji{font-size:28px;flex-shrink:0}
.bname{font-weight:700;font-size:1em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex-shrink:1}
.muted{color:var(--muted);font-size:0.95em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.price{font-weight:900;color:var(--accent);white-space:nowrap}
.inventory{display:flex;flex-direction:column;gap:10px}
.inv-item{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;padding:12px;border-radius:12px;background:#050505;border:1px solid #151515;min-width:0;font-size:1em}
.inv-sub{color:var(--muted);font-size:0.95em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.float{position:fixed;right:18px;top:18px;padding:10px 14px;border-radius:999px;background:#0c0c0c;border:1px solid #141414;color:var(--accent);font-weight:900;opacity:0;transform:translateY(-6px) scale(.98);transition:transform 420ms cubic-bezier(.2,.9,.2,1),opacity 420ms}
.float.show{opacity:1;transform:translateY(-26px) scale(1)}
#pcWarning{display:none;text-align:center;color:var(--accent);font-weight:900;font-size:28px;line-height:1.5}
#pcWarning .emoji{font-size:80px;margin-bottom:20px;display:block}
#mainUI, .bnav{display:none}
</style>
</head>
<body>
<div id="pcWarning">
  <span class="emoji">üê¶</span>
  –î–ª—è –∏–≥—Ä—ã –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ üì±
</div>
<div class="shell" id="mainUI">
<div class="top">
  <div class="info">
    <div class="coins">ü™ô <strong id="coins">0</strong> <span class="income">¬∑ <span id="income">0.00</span>/c</span></div>
  </div>
  <div class="primary">
    <button id="collect" class="btn">–°–æ–±—Ä–∞—Ç—å</button>
  </div>
</div>
<main class="panel" id="shopPanel">
  <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
  <div class="shop-grid" id="shop"></div>
</main>
<aside class="panel" id="side">
  <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
  <div class="inventory" id="inventory"></div>
  <div style="margin-top:12px;display:flex;justify-content:space-between" class="muted">
    <div>–î–æ—Ö–æ–¥/—Å–µ–∫</div>
    <div id="totalIncome">0.00</div>
  </div>
</aside>
</div>
<div class="bnav">
  <button id="nav-shop" class="btn">–ú–∞–≥–∞–∑–∏–Ω</button>
  <button id="nav-inv" class="btn btn--ghost">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
  <button id="nav-collect" class="btn">–°–æ–±—Ä–∞—Ç—å</button>
</div>
<div id="float" class="float">+0</div>
<script>
const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
const SHOP=[
  {id:'sparrow',name:'–í–æ—Ä–æ–±–µ–π',emoji:'üê¶',base:5,income:0.05},
  {id:'pigeon',name:'–ì–æ–ª—É–±—å',emoji:'üïäÔ∏è',base:30,income:0.35},
  {id:'chick',name:'–¶—ã–ø–ª—ë–Ω–æ–∫',emoji:'üê§',base:80,income:1},
  {id:'magpie',name:'–°–æ—Ä–æ–∫–∞',emoji:'ü™∂',base:220,income:3.2},
  {id:'owl',name:'–°–æ–≤–∞',emoji:'ü¶â',base:600,income:9},
  {id:'hawk',name:'–Ø—Å—Ç—Ä–µ–±',emoji:'ü¶Ö',base:1600,income:28},
  {id:'rooster',name:'–ü–µ—Ç—É—Ö',emoji:'üêì',base:4800,income:85},
  {id:'parrot',name:'–ü–æ–ø—É–≥–∞–π',emoji:'ü¶ú',base:13500,income:250},
  {id:'duck',name:'–£—Ç—ë–Ω–æ–∫',emoji:'ü¶Ü',base:42000,income:760},
  {id:'mythic',name:'–õ–µ–≥–µ–Ω–¥–∞',emoji:'‚ú®',base:125000,income:2300}
];
const KEY='crowmrkt_dynamic';
let state={coins:200,birds:{},last:Date.now()};
const $=id=>document.getElementById(id);
const fmt=n=>Math.floor(n).toLocaleString('ru-RU');
const fmtF=n=>(Math.floor(n*100)/100).toLocaleString('ru-RU');
function load(){try{const raw=localStorage.getItem(KEY);if(raw)state=JSON.parse(raw);}catch(e){}}
function save(){state.last=Date.now();localStorage.setItem(KEY,JSON.stringify(state));}
function priceFor(it,owned){owned=owned||(state.birds[it.id]||0);return Math.ceil(it.base*Math.pow(1.12,owned));}
function totalIncome(){return SHOP.reduce((s,it)=>s+(state.birds[it.id]||0)*it.income,0)}
function animateCoin(amount){const f=$('float');f.textContent='+'+fmt(amount);f.classList.add('show');clearTimeout(f._t);f._t=setTimeout(()=>f.classList.remove('show'),900);}
function buy(id){const it=SHOP.find(s=>s.id===id);const price=priceFor(it);if(state.coins<price){animateCoin('–ù–µ—Ç –º–æ–Ω–µ—Ç'); return;}state.coins-=price;state.birds[id]=(state.birds[id]||0)+1;save(); renderShop(); renderInv(); updateTop(); animateCoin(it.income);}
function updateTop(){$('coins').textContent=fmt(state.coins);$('income').textContent=fmtF(totalIncome());$('totalIncome').textContent=fmtF(totalIncome());}
function collect(){save(); animateCoin('‚úî');}
function applyOffline(){const now=Date.now();const secs=Math.floor((now-state.last)/1000);if(secs>0){const earned=Math.floor(totalIncome()*secs);if(earned>0){state.coins+=earned; animateCoin(earned);}}}
function renderShop(){
  const out=$('shop'); out.innerHTML=''; SHOP.forEach(it=>{
    const owned=state.birds[it.id]||0;
    const price=priceFor(it);
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`<div class="row"><div class="bird"><div class="emoji">${it.emoji}</div><div><div class="bname">${it.name}</div><div class="muted">${owned} —à—Ç ¬∑ ${it.income}/c</div></div></div><div class="controls"><div class="price">${fmt(price)}</div><button class="btn buy" data-id="${it.id}">–ö—É–ø–∏—Ç—å</button></div></div>`;
    out.appendChild(card);
  });
  out.querySelectorAll('button.buy').forEach(b=>b.onclick=()=>buy(b.dataset.id));
}
function renderInv(){
  const inv=$('inventory');
  inv.innerHTML='';
  SHOP.filter(it=>state.birds[it.id]>0).forEach(it=>{
    const cnt=state.birds[it.id];
    const el=document.createElement('div');
    el.className='inv-item';
    el.innerHTML=`<div style="display:flex;gap:10px;align-items:center;min-width:0"><div class="emoji">${it.emoji}</div><div style="min-width:0;overflow:hidden"><div style="font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${it.name}</div><div class="inv-sub">${fmtF(it.income*cnt)}/c</div></div></div><div class="inv-sub">√ó${cnt}</div>`;
    inv.appendChild(el);
  });
}
(function(){
  if(!isMobile){
    $('pcWarning').style.display='block';
  } else {
    $('mainUI').style.display='grid';
    load(); applyOffline(); save(); renderShop(); renderInv(); updateTop();
    setInterval(()=>{state.coins+=totalIncome();updateTop();save();},1000);
    $('collect').onclick=collect;
    document.getElementById('nav-shop').onclick=()=>{document.getElementById('shopPanel').style.display='block';document.getElementById('side').style.display='none';};
    document.getElementById('nav-inv').onclick=()=>{document.getElementById('shopPanel').style.display='none';document.getElementById('side').style.display='block';};
    document.getElementById('nav-collect').onclick=collect;
  }
})();
</script>
</body>
</html>
